<!DOCTYPE html>

<html lang="en">
<head>
	<!-- Metadata -->
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="description" content="" />

	<!-- Title -->
	<title>poc</title>

	<!-- Libraries -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/modern-normalize/modern-normalize.min.css" />

	<!-- Stylesheets -->
	<link rel="stylesheet" href="main.css" />

	<!-- Inline Stylesheet -->
	<style>
		body {	
			display: flex;
			flex-direction: column;
			height: 100vh;
			overflow-x: hidden;
		}

		.resizer[data-direction='horizontal'] {
			background-color: #cbd5e0;
			cursor: ew-resize;
			height: 100%;
			/* width: 2px; */
		}
		.resizer[data-direction='vertical'] {
			background-color: #cbd5e0;
			cursor: ns-resize;
			/* height: 2px; */
			width: 100%;
		}

		
		main {
			display: flex;
			flex-grow: 1;
		}
		nav {
			display: flex;
			min-width: 12.5%;
		}
		#sidebar {
			flex-grow: 1;
		}
		section {
			display: flex;
			flex-direction: column;
			flex-grow: 1;
		}
		#editor {
			height: 75%;
		}
		#editors {
			height: 100%;
		}
		#panel {
			flex-grow: 1;
		}
		#panels {
			height: 100%;
		}
  
	</style>
</head>
<body>
	<main>
		<nav>
			<div id="activityBar"></div>
			<div id="sidebar"></div>
		</nav>

		<div class="resizer" data-direction="horizontal"></div>

		<section>
			<div id="editor" class="container__top">
				<div id="editors"></div>
			</div>

			<div class="resizer" data-direction="vertical"></div>

			<div id="panel">
				<div id="panels"></div>
			</div>
		</section>
	</main>

	<footer>
		<div id="statusBar"></div>
	</footer>

	<script type="module" src="main.js"></script>

	<script>
		function resizable(resizer) {
			const direction = resizer.getAttribute('data-direction') || 'horizontal';
			const prevSibling = resizer.previousElementSibling;
			const nextSibling = resizer.nextElementSibling;

			// The current position of mouse
			let x = 0;
			let y = 0;
			let prevSiblingHeight = 0;
			let prevSiblingWidth = 0;

			function mouseMoveHandler(e) {
				// How far the mouse has been moved
				const dx = e.clientX - x;
				const dy = e.clientY - y;

				switch (direction) {
					case 'vertical':
						const h =
							((prevSiblingHeight + dy) * 100) /
							resizer.parentNode.getBoundingClientRect().height;
						prevSibling.style.height = `${h}%`;
						break;
					case 'horizontal':
					default:
						const w =
							((prevSiblingWidth + dx) * 100) / resizer.parentNode.getBoundingClientRect().width;
						prevSibling.style.width = `${w}%`;
						break;
				}

				const cursor = direction === 'horizontal' ? 'col-resize' : 'row-resize';
				resizer.style.cursor = cursor;
				document.body.style.cursor = cursor;

				prevSibling.style.userSelect = 'none';
				prevSibling.style.pointerEvents = 'none';

				nextSibling.style.userSelect = 'none';
				nextSibling.style.pointerEvents = 'none';
			};

			// Attach the handler
			resizer.addEventListener('mousedown', function(e) {
				// Get the current mouse position
				x = e.clientX;
				y = e.clientY;
				const rect = prevSibling.getBoundingClientRect();
				prevSiblingHeight = rect.height;
				prevSiblingWidth = rect.width;

				// Attach the listeners to `document`
				document.addEventListener('mousemove', mouseMoveHandler);
				document.addEventListener('mouseup', function mouseUpHandler() {
					resizer.style.removeProperty('cursor');
					document.body.style.removeProperty('cursor');

					prevSibling.style.removeProperty('user-select');
					prevSibling.style.removeProperty('pointer-events');

					nextSibling.style.removeProperty('user-select');
					nextSibling.style.removeProperty('pointer-events');

					// Remove the handlers of `mousemove` and `mouseup`
					document.removeEventListener('mousemove', mouseMoveHandler);
					document.removeEventListener('mouseup', mouseUpHandler);
				});
			});
		};

		document.addEventListener('DOMContentLoaded', function () {
			for (const element of document.querySelectorAll('.resizer')) {
				resizable(element);
			}

		});
	</script>
</body>
</html>
